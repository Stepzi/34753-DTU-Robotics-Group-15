function tau = invDyn(q,q_d,q_dd)
%INVDYN Computes the joint torque-vector given the joint angles,angular
%velocity and angular accelleration.
%   Detailed explanation goes here


D=[2.8444e-05*sin(q(1)+q(2)+q(3))-1.4606e-05*sin(q(1)-q(2))-1.0846e-04*cos(2*q(2)+2*q(3)+q(4)+0.5404)-8.1468e-04*cos(2*q(2)+q(3))-6.7770e-04*cos(2*q(2))-3.3174e-04*cos(2*q(2)+2*q(3))+1.0846e-04*cos(q(4)+0.5404)-1.7000e-05*cos(2*q(2)+2*q(3)+2*q(4)+1.0808)+1.4606e-05*sin(q(2)-q(1)+q(3))+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+2.8444e-05*sin(q(1)+q(2))-1.0846e-04*cos(2*q(2)+q(3)+q(4)+0.5404)-1.2300e-05*cos(q(1))+8.1468e-04*cos(q(3))+1.0846e-04*cos(q(3)+q(4)+0.5404)+0.0010,7.6875e-06*cos(2*q(1)+2*q(2)+2*q(3)+2*q(4))-1.4606e-05*cos(2*q(1))-7.3031e-06*cos(2*q(2))+1.4222e-05*cos(2*q(1)+2*q(2)+2*q(3))+1.4222e-05*cos(2*q(1)+2*q(2))-7.3031e-06*cos(2*q(2)+2*q(3))+3.6131e-05,7.6875e-06*cos(2*q(1)+2*q(2)+2*q(3)+2*q(4))-7.3031e-06*cos(2*q(1))+1.4222e-05*cos(2*q(1)+2*q(2)+2*q(3))-7.3031e-06*cos(2*q(2)+2*q(3))+2.1909e-05,7.6875e-06*cos(2*q(1)+2*q(2)+2*q(3)+2*q(4))+7.6875e-06;
0,3.6900e-05*sin(q(1)+q(2)+q(3))+2.1691e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+3.6900e-05*sin(q(1)+q(2))+0.0016*cos(q(3))+2.1691e-04*cos(q(3)+q(4)+0.5404)+0.0021,3.6900e-05*sin(q(1)+q(2)+q(3))+2.1691e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+8.1468e-04*cos(q(3))+1.0846e-04*cos(q(3)+q(4)+0.5404)+6.9748e-04,1.0846e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+1.0846e-04*cos(q(3)+q(4)+0.5404)+3.4000e-05;
0,3.6900e-05*sin(q(1)+q(2)+q(3))+2.1691e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+8.1468e-04*cos(q(3))+1.0846e-04*cos(q(3)+q(4)+0.5404)+6.9748e-04,3.6900e-05*sin(q(1)+q(2)+q(3))+2.1691e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+6.9748e-04,1.0846e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+3.4000e-05;
0,1.0846e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+1.0846e-04*cos(q(3)+q(4)+0.5404)+3.4000e-05,1.0846e-04*cos(q(4)+0.5404)+1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+3.4000e-05,1.5375e-05*sin(q(1)+q(2)+q(3)+q(4))+3.4000e-05];

C=[q_d(2)*(7.3031e-06*cos(q(1)-q(2))+8.1468e-04*sin(2*q(2)+q(3))-7.6875e-06*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))-4.2281e-06*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+1.4606e-05*sin(2*q(1))+6.7770e-04*sin(2*q(2))-1.4222e-05*sin(2*q(1)+2*q(2)+2*q(3))-1.4222e-05*sin(2*q(1)+2*q(2))+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)-4.2281e-06*cos(q(1)+q(2))+1.0846e-04*sin(2*q(2)+q(3)+q(4)+0.5404))+q_d(3)*(4.0734e-04*sin(2*q(2)+q(3))-7.6875e-06*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))-4.2281e-06*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+7.3031e-06*sin(2*q(1))-1.4222e-05*sin(2*q(1)+2*q(2)+2*q(3))+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-4.0734e-04*sin(q(3))-5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(1)*(1.4222e-05*cos(q(1)+q(2)+q(3))-7.3031e-06*cos(q(1)-q(2))-7.3031e-06*cos(q(2)-q(1)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.4222e-05*cos(q(1)+q(2))+6.1500e-06*sin(q(1)))-q_d(4)*(7.6875e-06*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))-5.4228e-05*sin(2*q(2)+2*q(3)+q(4)+0.5404)+5.4228e-05*sin(q(4)+0.5404)-1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)-5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)+5.4228e-05*sin(q(3)+q(4)+0.5404)),q_d(1)*(1.4606e-05*cos(q(1)-q(2))+8.1468e-04*sin(2*q(2)+q(3))-7.6875e-06*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+1.4606e-05*sin(2*q(1))+6.7770e-04*sin(2*q(2))-1.4222e-05*sin(2*q(1)+2*q(2)+2*q(3))-1.4222e-05*sin(2*q(1)+2*q(2))+3.3174e-04*sin(2*q(2)+2*q(3))+1.4606e-05*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+1.0846e-04*sin(2*q(2)+q(3)+q(4)+0.5404)-6.1500e-06*sin(q(1)))-q_d(4)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4)))-q_d(3)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.8450e-05*cos(q(1)+q(2)+q(3))+2.8444e-05*sin(2*q(1)+2*q(2)+2*q(3))-1.4606e-05*sin(2*q(2)+2*q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4)))-q_d(2)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.8450e-05*cos(q(1)+q(2)+q(3))-1.4606e-05*sin(2*q(2))+2.8444e-05*sin(2*q(1)+2*q(2)+2*q(3))+2.8444e-05*sin(2*q(1)+2*q(2))-1.4606e-05*sin(2*q(2)+2*q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.8450e-05*cos(q(1)+q(2))),q_d(1)*(7.3031e-06*cos(q(1)-q(2))+4.0734e-04*sin(2*q(2)+q(3))-7.6875e-06*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+7.3031e-06*sin(2*q(1))-1.4222e-05*sin(2*q(1)+2*q(2)+2*q(3))+3.3174e-04*sin(2*q(2)+2*q(3))+1.4606e-05*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)-1.4222e-05*cos(q(1)+q(2))+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-6.1500e-06*sin(q(1))-4.0734e-04*sin(q(3))-5.4228e-05*sin(q(3)+q(4)+0.5404))-q_d(3)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.8450e-05*cos(q(1)+q(2)+q(3))+2.8444e-05*sin(2*q(1)+2*q(2)+2*q(3))-1.4606e-05*sin(2*q(2)+2*q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4)))-q_d(2)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.8450e-05*cos(q(1)+q(2)+q(3))+2.8444e-05*sin(2*q(1)+2*q(2)+2*q(3))-1.4606e-05*sin(2*q(2)+2*q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.8450e-05*cos(q(1)+q(2)))-q_d(4)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))),-q_d(4)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4)))-q_d(1)*(7.6875e-06*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))-7.3031e-06*cos(q(1)-q(2))+1.4222e-05*cos(q(1)+q(2)+q(3))-5.4228e-05*sin(2*q(2)+2*q(3)+q(4)+0.5404)-7.3031e-06*cos(q(2)-q(1)+q(3))+5.4228e-05*sin(q(4)+0.5404)-1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+1.4222e-05*cos(q(1)+q(2))-5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)+6.1500e-06*sin(q(1))+5.4228e-05*sin(q(3)+q(4)+0.5404))-q_d(2)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.8450e-05*cos(q(1)+q(2)))-q_d(3)*(1.5375e-05*sin(2*q(1)+2*q(2)+2*q(3)+2*q(4))+1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4)));
-q_d(1)*(7.3031e-06*cos(q(1)-q(2))+8.1468e-04*sin(2*q(2)+q(3))+1.4222e-05*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+6.7770e-04*sin(2*q(2))+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+1.4222e-05*cos(q(1)+q(2))+1.0846e-04*sin(2*q(2)+q(3)+q(4)+0.5404)),q_d(2)*(1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.8450e-05*cos(q(1)+q(2)))-q_d(1)*(7.3031e-06*cos(q(1)-q(2))+8.1468e-04*sin(2*q(2)+q(3))-4.2281e-06*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+6.7770e-04*sin(2*q(2))+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)-4.2281e-06*cos(q(1)+q(2))+1.0846e-04*sin(2*q(2)+q(3)+q(4)+0.5404))-q_d(4)*(1.0846e-04*sin(q(4)+0.5404)-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(3)+q(4)+0.5404))+q_d(3)*(1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-8.1468e-04*sin(q(3))-1.0846e-04*sin(q(3)+q(4)+0.5404)),q_d(3)*(1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-8.1468e-04*sin(q(3))-1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(4)*(1.0846e-04*sin(q(4)+0.5404)-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(1)*(7.3031e-06*cos(q(1)-q(2))+8.1468e-04*sin(2*q(2)+q(3))-4.2281e-06*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+6.7770e-04*sin(2*q(2))+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+1.4222e-05*cos(q(1)+q(2))+1.0846e-04*sin(2*q(2)+q(3)+q(4)+0.5404))-q_d(2)*(1.8450e-05*cos(q(1)+q(2))-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-1.8450e-05*cos(q(1)+q(2)+q(3))+8.1468e-04*sin(q(3))+1.0846e-04*sin(q(3)+q(4)+0.5404)),-q_d(3)*(1.8450e-05*cos(q(1)+q(2)+q(3))-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(4)+0.5404)+1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(4)*(1.0846e-04*sin(q(4)+0.5404)-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(2)*(1.8450e-05*cos(q(1)+q(2)+q(3))-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(4)+0.5404)+1.8450e-05*cos(q(1)+q(2))+1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(1)*(7.3031e-06*cos(q(1)-q(2))+8.1468e-04*sin(2*q(2)+q(3))+1.4222e-05*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+6.7770e-04*sin(2*q(2))+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+1.4222e-05*cos(q(1)+q(2))+1.0846e-04*sin(2*q(2)+q(3)+q(4)+0.5404));
q_d(2)*(8.1468e-04*sin(q(3))+1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(1)*(4.0734e-04*sin(2*q(2)+q(3))+1.4222e-05*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-4.0734e-04*sin(q(3))-5.4228e-05*sin(q(3)+q(4)+0.5404)),q_d(3)*(1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-4.0734e-04*sin(q(3))-5.4228e-05*sin(q(3)+q(4)+0.5404))-q_d(1)*(4.0734e-04*sin(2*q(2)+q(3))-4.2281e-06*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-4.0734e-04*sin(q(3))-5.4228e-05*sin(q(3)+q(4)+0.5404))-q_d(4)*(1.0846e-04*sin(q(4)+0.5404)-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(2)*(1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+8.1468e-04*sin(q(3))+1.0846e-04*sin(q(3)+q(4)+0.5404)),q_d(3)*(1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4)))-q_d(1)*(4.0734e-04*sin(2*q(2)+q(3))-4.2281e-06*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-4.0734e-04*sin(q(3))-5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(2)*(1.8450e-05*cos(q(1)+q(2)+q(3))+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+4.0734e-04*sin(q(3))+5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(4)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-1.0846e-04*sin(q(4)+0.5404)),q_d(4)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-1.0846e-04*sin(q(4)+0.5404))-q_d(3)*(1.8450e-05*cos(q(1)+q(2)+q(3))-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(4)+0.5404))-q_d(1)*(4.0734e-04*sin(2*q(2)+q(3))+1.4222e-05*cos(q(1)+q(2)+q(3))+1.0846e-04*sin(2*q(2)+2*q(3)+q(4)+0.5404)+3.3174e-04*sin(2*q(2)+2*q(3))+7.3031e-06*cos(q(2)-q(1)+q(3))+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-4.0734e-04*sin(q(3))-5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(2)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-1.8450e-05*cos(q(1)+q(2)+q(3))-1.0846e-04*sin(q(4)+0.5404)+8.1468e-04*sin(q(3))+5.4228e-05*sin(q(3)+q(4)+0.5404));
q_d(2)*(1.0846e-04*sin(q(4)+0.5404)+1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(1)*(5.4228e-05*sin(2*q(2)+2*q(3)+q(4)+0.5404)+7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-5.4228e-05*sin(q(4)+0.5404)+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-5.4228e-05*sin(q(3)+q(4)+0.5404))+1.0846e-04*q_d(3)*sin(q(4)+0.5404),q_d(2)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(4)+0.5404)+1.0846e-04*sin(q(3)+q(4)+0.5404))-q_d(1)*(5.4228e-05*sin(2*q(2)+2*q(3)+q(4)+0.5404)-5.4228e-05*sin(q(4)+0.5404)+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(3)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(4)+0.5404)-5.4228e-05*sin(q(3)+q(4)+0.5404))-q_d(4)*(5.4228e-05*sin(q(4)+0.5404)-7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+5.4228e-05*sin(q(3)+q(4)+0.5404)),q_d(2)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(4)+0.5404)+5.4228e-05*sin(q(3)+q(4)+0.5404))-q_d(1)*(5.4228e-05*sin(2*q(2)+2*q(3)+q(4)+0.5404)-5.4228e-05*sin(q(4)+0.5404)+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(3)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+1.0846e-04*sin(q(4)+0.5404))+q_d(4)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))-5.4228e-05*sin(q(4)+0.5404)),7.6875e-06*q_d(4)*cos(q(1)+q(2)+q(3)+q(4))-q_d(1)*(5.4228e-05*sin(2*q(2)+2*q(3)+q(4)+0.5404)-5.4228e-05*sin(q(4)+0.5404)+1.7000e-05*sin(2*q(2)+2*q(3)+2*q(4)+1.0808)+5.4228e-05*sin(2*q(2)+q(3)+q(4)+0.5404)-5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(2)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+5.4228e-05*sin(q(4)+0.5404)+5.4228e-05*sin(q(3)+q(4)+0.5404))+q_d(3)*(7.6875e-06*cos(q(1)+q(2)+q(3)+q(4))+5.4228e-05*sin(q(4)+0.5404))];


g=[0;
-0.0059*cos(q(2)+q(3)+q(4))-0.0098*sin(q(2)+q(3)+q(4))-0.0859*sin(q(2)+q(3))-0.1589*sin(q(2));
-0.0059*cos(q(2)+q(3)+q(4))-0.0098*sin(q(2)+q(3)+q(4))-0.0859*sin(q(2)+q(3));
-0.0059*cos(q(2)+q(3)+q(4))-0.0098*sin(q(2)+q(3)+q(4))];


tau = D*q_dd+C*q_d+g;
end

